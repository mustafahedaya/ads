<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>SyncPlay - Security Check</title>
    
    <!-- كود الإعلان الخاص بك -->
    <script id="adScript" data-cfasync="false" src="//dcbbwymp1bhlf.cloudfront.net/?wbbcd=1232573"></script>
    
    <style>
        body { background: #0a0a0b; color: #fff; text-align: center; padding-top: 100px; font-family: sans-serif; }
        .box { border: 2px solid #00e676; padding: 40px; border-radius: 20px; display:inline-block; max-width: 400px; }
        .blocked-msg { color: #ff5252; display: none; margin-top: 20px; font-weight: bold; }
        button { padding: 15px 30px; font-size: 18px; background: #00e676; border: none; cursor: pointer; border-radius: 10px; font-weight: bold; }
        button:disabled { background: #333; cursor: not-allowed; color: #666; }
    </style>
</head>
<body>

    <div class="box">
        <h2 id="title">Reward Verification</h2>
        <p id="desc">Please click the button to verify and unlock your extra room.</p>
        
        <button id="unlockBtn" disabled>Checking...</button>
        
        <div id="adblockMsg" class="blocked-msg">
            ⚠️ AdBlock Detected!<br>
            Please disable AdBlock for this site and refresh to continue.
        </div>
    </div>

    <script>
        const unlockBtn = document.getElementById('unlockBtn');
        const adblockMsg = document.getElementById('adblockMsg');

        // دالة للتحقق من تحميل كود الإعلان
        function checkAdStatus() {
            // معظم مانعي الإعلانات يحذفون المتغيرات التي ينشئها كود الإعلان
            // سنفحص إذا كان ملف الإعلان قد تم تحميله فعلاً
            const adLoaded = (typeof P7Q !== 'undefined');

            if (adLoaded) {
                unlockBtn.disabled = false;
                unlockBtn.innerText = "Unlock Now";
                adblockMsg.style.display = 'none';
            } else {
                unlockBtn.disabled = true;
                unlockBtn.innerText = "Action Blocked";
                adblockMsg.style.display = 'block';
            }
        }

        // انتظر ثانية للتأكد من انتهاء محاولة التحميل
        setTimeout(checkAdStatus, 1500);

        unlockBtn.onclick = function() {
            this.innerText = "Redirecting...";
            this.disabled = true;

            const urlParams = new URLSearchParams(window.location.search);
            let extId = urlParams.get('extId') || "bkkbcggnhapdmkeljlodobbkopceiche";

            setTimeout(() => {
                window.location.href = `chrome-extension://${extId}/success.html`;
            }, 6000);
        };
    </script>
</body>
</html>
